SELECT SYSDATE FROM DUAL;
SELECT HIREDATE FROM EMP;
SELECT TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') AS 현재날짜시간 FROM DUAL;

SELECT SYSDATE,
    TO_CHAR(SYSDATE,'MM')AS MM,
    TO_CHAR(SYSDATE, 'MON') AS MON,
    TO_CAHR(SYSDATE, 'MONTH') AS MONTH,
    TO_CHAR(SYSDATE, 'DD') AS DD,
    TO_CHAR(SYSDATE, 'DY') AS DY,
    TO_CHAR(SYSDATE, 'DAY') AS DAY
    FROM EMP;
    
SELECT SYSDATE,
    TO_CHAR(SYSDATE, 'MM') AS MM,
    TO_CHAR(SYSDATE, 'DD') AS DD,
    TO_CHAR(SYSDATE, 'DY', 'NLS_DATE_LANGUAGE=KOREAN')AS DY_KOR,
    TO_CHAR(SYSDATE, 'DY', 'NLS_DATE_LANGUAGE=JAPANESE') AS DY_JPN,
    TO_CHAR(SYSDATE, 'DY', 'NLS_DATE_LANGUAGE=ENGLISH') AS DY_ENG,
    TO_CHAR(SYSDATE, 'DAY', 'NLS_DATE_LANGUAGE=KOREAN') AS DAY_KOR,
    TO_CHAR(SYSDATE, 'DAY', 'NLS_DATE_LANGUAGE=JAPANESE') AS DAY_JPN,
    TO_CHAR(SYSDATE, 'DAY', 'NLS_DATE_LANGUAGE=ENGLISH') AS DAY_ENG
    FROM DUAL;
    
SELECT ENAME,
    TO_CHAR(SAL, '$999,999') AS SAL_$,
    TO_CHAR(SAL, 'L0,999') AS SAL_L,
    TO_CHAR(SAL, '999,999.00') AS SAL_1,
    TO_CHAR(SAL, '000,999,999.00') AS SAL_2
    FROM EMP;
    
SELECT TO_NUMBER('1,300','999,999') - To_NUMBER('1,500','999,999')
FROM DUAL;

SELECT TO_DATE('2018/07/14', 'YY/MM/DD')
FROM DUAL;

SELECT  * FROM EMP
 WHERE HIREDATE >'1981/06/01';        
 
 SELECT  ENAME, SAL, COMM, SAL+COMM,
           NVL(COMM,0),
           SAL+NVL(COMM,0)
  FROM EMP;
  
SELECT  EMPNO, ENAME, SAL, COMM, 
           NVL2(COMM,'O','X'),
           NVL2(COMM,SAL*12+COMM, SAL*12) AS 연봉
  FROM EMP;
        
SELECT SUM(SAL) FROM EMP;

SELECT COUNT(*)
FROM EMP;

SELECT COUNT(EMPNO) FROM EMP;

SELECT * FROM DEPT;
SELECT COUNT(DISTINCT DEPTNO) FROM EMP;

SELECT COUNT(COMM) 
FROM EMP;

SELECT COUNT(COMM)
  FROM EMP
 WHERE COMM IS NOT NULL;
 
SELECT MAX(SAL)
FROM EMP
WHERE DEPTNO = 20;

SELECT MIN(SAL)
FROM EMP
WHERE DEPTNO = 10;

SELECT MAX(HIREDATE)
  FROM EMP
 WHERE DEPTNO = 20;
 
 SELECT MIN(HIREDATE)
 FROM EMP
 WHERE DEPTNO = 20;
 
 SELECT AVG(SAL) 
 FROM EMP
 WHERE DEPTNO = 30;
 
 SELECT AVG(DISTINCT SAL)
  FROM EMP
 WHERE DEPTNO = 30 ;
 
 SELECT DEPTNO, AVG(SAL)
 FROM EMP
 GROUP BY DEPTNO
 ORDER BY DEPTNO ASC;
 
 SELECT *
 FROM EMP, DEPT
 ORDER BY EMPNO;
 
CREATE  TABLE  EMP_T1 ( EMPNO NUMBER(4), ENAME VARCHAR2(10) );
INSERT INTO EMP_T1 (EMPNO, ENAME) VALUES ( 1111, 'KIM' );
INSERT INTO EMP_T1 (EMPNO, ENAME) VALUES ( 2222, 'YI' );

CREATE  TABLE  DEPT_T1 ( DEPTNO NUMBER(4), LOC VARCHAR2(10) );
INSERT INTO  DEPT_T1 (DEPTNO, LOC) VALUES ( 10, 'LA' );
INSERT INTO  DEPT_T1 (DEPTNO, LOC) VALUES ( 20, 'New York' );

SELECT * FROM EMP_T1, DEPT_T1;

SELECT  *   FROM EMP, DEPT
 WHERE EMP.DEPTNO = DEPT.DEPTNO  ORDER BY EMPNO;
 
 SELECT *
 FROM EMP E, DEPT D
 WHERE E.DEPTNO = D.DEPTNO;
 
 SELECT  E.EMPNO, E.ENAME, D.DEPTNO, D.DNAME, D.LOC  
   FROM EMP E, DEPT D
 WHERE E.DEPTNO = D.DEPTNO;
 
 SELECT E.EMPNO, E.ENAME, E.SAL, D.DEPTNO, D.DNAME, D.LOC
  FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO
  AND SAL >= 3000;
  
SELECT E.ENAME,D.DNAME
FROM EMP E, DEPT D
WHERE E.DEPTNO = 10;

SELECT DEPTNO, JOB, AVG(SAL)
FROM EMP
GROUP BY DEPTNO, JOB
ORDER BY DEPTNO, JOB;

SELECT DEPTNO, AVG(SAL)
FROM EMP
GROUP BY DEPTNO
HAVING AVG(SAL) >= 2000; --DEPTNO(부선번호)로 그룹화한 후, 각부서별 평균급여 2000이상

SELECT DEPTNO, MAX(SAL), MIN(SAL)
FROM EMP
GROUP BY DEPTNO
HAVING MAX(SAL) >= 2900;



--실습1번
SELECT ENAME,
    TO_CHAR(SAL, '$9,999')AS SAL
FROM EMP
WHERE DEPTNO = 10;

--실습2번
SELECT COUNT(*), AVG(SAL)
  FROM EMP;

  
--실습3번
SELECT DEPTNO, COUNT(*)
FROM EMP
GROUP BY DEPTNO
HAVING COUNT(*)>4;

--실습4번
SELECT DEPTNO, AVG(SAL)
FROM EMP
GROUP BY DEPTNO --DEPTNO별로 GROUP BY
HAVING MAX(SAL) >= 2000 --그룹화시킨 조건식
ORDER BY AVG(SAL);


--실습5번
--EMP테이블에서 업무(JOB)별 전체 급여(SAL)가 3000을 초과하는 각 업무에 대해서 업무와 급여의 합계를 출력하라.
SELECT JOB, SUM(SAL) "급여합계"
FROM EMP  
GROUP BY JOB              -- 업무별로 Group By 
HAVING SUM(SAL) > 3000     -- 전체 월급이 3000을 초과하는
ORDER BY SUM(SAL);

--실습6번
--EMP테이블에서 사원이름에 'A'가 포함된 사원의 이름과 급여를 나타내라.
SELECT ENAME, SAL
FROM EMP
WHERE ENAME LIKE '%A%';

--실습7번
--조인실습(EMP,DEPT 테이블 이용)--
--업무(JOB)가 CLERK인 사원들에 대해 사원이름,부서명을 출력하라.
SELECT  E.ENAME, D.DNAME  
FROM EMP E, DEPT D
 WHERE E.DEPTNO = D.DEPTNO
 AND JOB = 'CLERK';

--실습8번
--SMITH사원의 사원번호(EMPNO)와 부서명(DNAME)을 출력하라.
SELECT E.EMPNO, D.DNAME
from EMP E, DEPT D 
where d.deptno = e.deptno and e.ename = 'SMITH';

